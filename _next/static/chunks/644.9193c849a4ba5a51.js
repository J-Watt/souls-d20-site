"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[644],{8644:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var l=a(5155),s=a(2115),r=a(6676),i=a(5261),o=a(6938),n=a(6913);function c(){let[e,t]=(0,s.useState)(0),[a,i]=(0,s.useState)(0),[c,d]=(0,s.useState)(null),[u,h]=(0,s.useState)(null),[m,f]=(0,s.useState)(800),[p,x]=(0,s.useState)(600),[v,w]=(0,s.useState)(1.414),g=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=g.current;if(!e)return;let t=new ResizeObserver(e=>{let[t]=e,{width:a,height:l}=t.contentRect;f(Math.max(320,Math.floor(a))),x(Math.max(420,Math.floor(l)))});return t.observe(e),()=>t.disconnect()},[]),(0,s.useEffect)(()=>{let e=!1;return(async()=>{try{let t=await fetch("/book/Souls_D20_Book.pdf",{cache:"force-cache"});if(!t.ok)throw Error("HTTP ".concat(t.status));let a=await t.arrayBuffer();e||d(a)}catch(a){var t;e||h("Failed to load PDF: ".concat(null!=(t=null==a?void 0:a.message)?t:"unknown error"))}})(),()=>{e=!0}},[]);let k=(0,s.useMemo)(()=>c?{data:c}:null,[c]),y=(0,s.useMemo)(()=>Array.from({length:e||2},(e,t)=>t+1),[e]),j=m>p||m>=900,b=Math.max(0,m-32),N=Math.max(320,Math.min(j?Math.floor(b/2):b,Math.floor(Math.max(0,p-32)/v))),S=Math.floor(N*v),M=j?2*N:N,E="".concat(j?"spread":"single","-").concat(M,"x").concat(S),P=e>0&&a>=e;return(0,l.jsxs)("div",{ref:g,className:"w-full h-[88vh] flex items-center justify-center relative",style:{padding:16},children:[!P&&(0,l.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-black/40 backdrop-blur-sm rounded-xl",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 text-sm sm:text-base",children:[(0,l.jsxs)("svg",{className:"h-6 w-6 animate-spin",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),(0,l.jsxs)("span",{className:"font-medium",children:["Loading…",e?" (".concat(a,"/").concat(e,")"):""]})]})}),!k&&!u&&(0,l.jsx)("div",{className:"opacity-70 p-6",children:"Loading PDF…"}),u&&(0,l.jsxs)("div",{className:"opacity-70 p-6",children:["Couldn't load PDF. ",u]}),k&&(0,l.jsx)(o.A,{file:k,onLoadSuccess:e=>{let{numPages:a}=e;t(a),i(0)},loading:(0,l.jsx)("div",{className:"opacity-70 p-6",children:"Preparing pages…"}),error:(0,l.jsx)("div",{className:"opacity-70 p-6",children:"PDF render error."}),className:"w-full h-full relative",children:(0,l.jsx)(r.A,{size:"fixed",autoSize:!1,width:N,height:S,minWidth:200,maxWidth:1200,minHeight:300,maxHeight:1600,flippingTime:600,mobileScrollSupport:!0,style:{width:"".concat(M,"px"),height:"".concat(S,"px"),margin:"0 auto",display:"block",opacity:P?1:.4,transition:"opacity 200ms ease"},usePortrait:!j,showCover:!0,startPage:0,drawShadow:!1,maxShadowOpacity:0,clickEventForward:!0,useMouseEvents:!0,swipeDistance:30,showPageCorners:!0,disableFlipByClick:!1,startZIndex:0,className:"html-flip-book rounded-xl overflow-hidden shadow-soft mx-auto",children:y.map(t=>(0,l.jsx)("div",{className:"page-content",children:(0,l.jsx)(n.A,{pageNumber:t,width:N,renderTextLayer:!1,renderAnnotationLayer:!1,onLoadSuccess:a=>{1===t&&(e=>{var t,a,l,s,r,i;let o=null!=(s=null!=(l=null==e?void 0:e.width)?l:null==e?void 0:e.originalWidth)?s:null==e||null==(t=e.view)?void 0:t[2],n=null!=(i=null!=(r=null==e?void 0:e.height)?r:null==e?void 0:e.originalHeight)?i:null==e||null==(a=e.view)?void 0:a[3];if(o&&n){let e=n/o;e>.2&&e<5&&Math.abs(e-v)>.01&&w(e)}})(a),i(t=>t<e?t+1:t)}})},t))},E)})]})}a(6589),a(4087),!function(){let e=i.rE||"latest",t="https://unpkg.com/pdfjs-dist@".concat(e,"/build/pdf.worker.min.mjs"),a="https://unpkg.com/pdfjs-dist@".concat(e,"/build/pdf.worker.min.js");i.EA.workerSrc=t,fetch(t,{method:"HEAD"}).then(e=>{if(!e.ok)throw Error()}).catch(()=>{i.EA.workerSrc=a})}()}}]);