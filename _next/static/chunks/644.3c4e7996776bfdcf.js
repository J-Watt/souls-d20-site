"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[644],{8644:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var l=a(5155),s=a(2115),o=a(6676),i=a(5261),r=a(6938),n=a(6913);function c(){let[e,t]=(0,s.useState)(0),[a,i]=(0,s.useState)(0),[c,d]=(0,s.useState)(null),[h,u]=(0,s.useState)(null),[m,p]=(0,s.useState)(800),[f,x]=(0,s.useState)(600),[v,g]=(0,s.useState)(1.414),w=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=w.current;if(!e)return;let t=new ResizeObserver(e=>{let[t]=e,{width:a,height:l}=t.contentRect;p(Math.max(320,Math.floor(a))),x(Math.max(420,Math.floor(l)))});return t.observe(e),()=>t.disconnect()},[]),(0,s.useEffect)(()=>{let e=!1;return(async()=>{try{let t=await fetch("/book/Souls_D20_Book.pdf",{cache:"force-cache"});if(!t.ok)throw Error("HTTP ".concat(t.status));let a=await t.arrayBuffer();e||d(a)}catch(a){var t;e||u("Failed to load PDF: ".concat(null!=(t=null==a?void 0:a.message)?t:"unknown error"))}})(),()=>{e=!0}},[]);let k=(0,s.useMemo)(()=>c?{data:c}:null,[c]),j=(0,s.useMemo)(()=>Array.from({length:Math.max(0,e-1)||1},(e,t)=>t+2),[e]),y=m>f||m>=900,b=Math.max(0,m-32),M=Math.max(320,Math.min(y?Math.floor(b/2):b,Math.floor(Math.max(0,f-32)/v))),S=Math.floor(M*v),N=y?2*M:M,E="".concat(y?"spread":"single","-").concat(N,"x").concat(S),C=e>0&&a>=e;return(0,l.jsxs)("div",{ref:w,className:"w-full h-[88vh] flex items-center justify-center relative",style:{padding:16},children:[!C&&(0,l.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-black/40 backdrop-blur-sm rounded-xl",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 text-sm sm:text-base",children:[(0,l.jsxs)("svg",{className:"h-6 w-6 animate-spin",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),(0,l.jsxs)("span",{className:"font-medium",children:["Loading…",e?" (".concat(a,"/").concat(e,")"):""]})]})}),!k&&!h&&(0,l.jsx)("div",{className:"opacity-70 p-6",children:"Loading PDF…"}),h&&(0,l.jsxs)("div",{className:"opacity-70 p-6",children:["Couldn't load PDF. ",h]}),k&&(0,l.jsx)(r.A,{file:k,onLoadSuccess:e=>{let{numPages:a}=e;t(a),i(0)},loading:(0,l.jsx)("div",{className:"opacity-70 p-6",children:"Preparing pages…"}),error:(0,l.jsx)("div",{className:"opacity-70 p-6",children:"PDF render error."}),className:"w-full h-full relative",children:(0,l.jsxs)(o.A,{size:"fixed",autoSize:!1,width:M,height:S,minWidth:200,maxWidth:1200,minHeight:300,maxHeight:1600,flippingTime:600,mobileScrollSupport:!0,style:{width:"".concat(N,"px"),height:"".concat(S,"px"),margin:"0 auto",display:"block",opacity:C?1:.4,transition:"opacity 200ms ease"},usePortrait:!y,showCover:!0,startPage:0,drawShadow:!1,maxShadowOpacity:0,clickEventForward:!0,useMouseEvents:!0,swipeDistance:30,showPageCorners:!0,disableFlipByClick:!1,startZIndex:0,className:"html-flip-book rounded-xl overflow-hidden shadow-soft mx-auto",children:[(0,l.jsx)("div",{className:"page-content",children:(0,l.jsx)("img",{src:"/book/Souls_D20_Book_Cover.jpg",alt:"Souls D20 Book Cover",style:{width:M,height:S,objectFit:"cover",display:"block"},onLoad:()=>{i(t=>Math.min(t+1,e))}})},"cover"),j.map(t=>(0,l.jsx)("div",{className:"page-content",children:(0,l.jsx)(n.A,{pageNumber:t,width:M,devicePixelRatio:2,renderMode:"canvas",canvasBackground:"white",renderTextLayer:!1,renderAnnotationLayer:!1,onLoadSuccess:a=>{2===t&&(e=>{var t,a,l,s,o,i;let r=null!=(s=null!=(l=null==e?void 0:e.width)?l:null==e?void 0:e.originalWidth)?s:null==e||null==(t=e.view)?void 0:t[2],n=null!=(i=null!=(o=null==e?void 0:e.height)?o:null==e?void 0:e.originalHeight)?i:null==e||null==(a=e.view)?void 0:a[3];if(r&&n){let e=n/r;e>.2&&e<5&&Math.abs(e-v)>.01&&g(e)}})(a),i(t=>t<e?t+1:t)}})},t))]},E)})]})}a(6589),a(4087),!function(){let e=i.rE||"latest",t="https://unpkg.com/pdfjs-dist@".concat(e,"/build/pdf.worker.min.mjs"),a="https://unpkg.com/pdfjs-dist@".concat(e,"/build/pdf.worker.min.js");i.EA.workerSrc=t,fetch(t,{method:"HEAD"}).then(e=>{if(!e.ok)throw Error()}).catch(()=>{i.EA.workerSrc=a})}()}}]);